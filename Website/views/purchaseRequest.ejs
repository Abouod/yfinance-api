<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Request Form</title>

    <!-- Include Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Link to CSS File -->
    <link rel="stylesheet" href="/styles/purchaseRequest.css">
    <!-- Include FontAwesome 5 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" />
</head>

<body>
    <nav class="custom-navbar">
        <div class="navbar-container">
            <div class="logo-container">
                <img class="logo" src="/images/Sophic-Logo-rotating-globe-2.gif" alt="Sophic Logo">
                <span class="bar">|</span>
                <span class="navbar-text">Sophic RPA Document Automation</span> <!-- Add text here -->
            </div>
            <!-- Example dropdown menu -->
            <div class="btn-group">
                <button type="button" class="btn custom-btn btn-primary dropdown-toggle" data-bs-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    <img src="/images/menu.png" alt="Bars Image">
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="/index">Home Page</a>
                    <a class="dropdown-item" href="/userProfile/profile">User Profile</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/auth/signout">Signout</a>
                </div>
            </div>
        </div>
    </nav>

    <form id="CreatePRForm" action="/purchase/submit" method="POST">
        <div class="container shadow rounded bg-white">
            <div class="row">
                <div class="shadow rounded">
                    <div class="row form-header">
                        <div class="d-flex justify-content-between align-items-center p-4">
                            <h4 style="color: white;" class="text-right">Purchase Request Form</h4>
                        </div>
                    </div>
                    <div class="row p-4">
                        <div class="col-md-4">
                            <label class="labels">Requisition No.</label>
                            <input id="requisitionNo" name="requisitionNo" type="text" value="<%= requisitionNo %>"
                                class="form-control" readonly>
                        </div>
                        <div class="col-md-4">
                            <label class="labels">Request by</label>
                            <input id="fullName" type="text" name="fullName" class="form-control"
                                value="<%= firstName %> <%= lastName %>" readonly>
                        </div>
                        <div class="col-md-4">
                            <label class="labels">Date</label>
                            <input id="requestDate" type="date" name="requestDate" class="form-control"
                                value="<%= new Date().toISOString().split('T')[0] %>" readonly>
                        </div>
                    </div>
                    <div class="row px-4">
                        <div class="col-md-3">
                            <label class="labels">Customer Name</label>
                            <input id="customerName" name="customerName" type="text" class="form-control" required>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Customer PO</label>
                            <input id="customerPo" name="customerPo" type="text" class="form-control" required>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Type for Purchase</label>
                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                <input type="radio" class="btn-check" value="FIXED ASSET" name="TFP" id="fixed-asset"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-danger" for="fixed-asset">Fixed
                                    Asset</label>

                                <input type="radio" class="btn-check" value="EXPENSE" name="TFP" id="expense"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-success expense-label" for="expense">Expense</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Quotation No.</label>
                            <input id="quotationNo" name="quotationNo" type="text" class="form-control" required>
                        </div>
                    </div>
                    <div class="row p-4">
                        <div class="col-md-3">
                            <label class="labels">Purchase Department</label>
                            <input id="purchaseDepartment" name="purchaseDepartment" type="text" class="form-control"
                                required>
                        </div>
                        <div class="col-md-3">
                            <label class="labels d-block">PR Type</label>
                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                <input type="radio" class="btn-check" value="Machine Build" name="prType" id="machine"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-danger" for="machine">Machine Build</label>

                                <input type="radio" class="btn-check" value="Trading" name="prType" id="trading"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-success trading-label" for="trading">Trading</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Supplier Name</label>
                            <input id="supplierName" name="supplierName" type="text" class="form-control" required>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Supplier Type</label>
                            <div class="btn-group" role="st-group" aria-label="Basic radio toggle button st-group">
                                <input type="radio" class="btn-check" value="OEM" name="ST" id="oem" autocomplete="off"
                                    required>
                                <label class="btn btn-outline-danger" for="oem">OEM</label>

                                <input type="radio" class="btn-check" value="OEM D*" name="ST" id="oemd"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-info" for="oemd">OEM D*</label>

                                <input type="radio" class="btn-check" value="TRADING" name="ST" id="st-trading"
                                    autocomplete="off" required>
                                <label class="btn btn-outline-success" for="st-trading">TRADING</label>
                            </div>
                        </div>
                    </div>
                    <div class="row px-4">
                        <div class="col-md-6">
                            <label class="labels">Sophic Project Category</label>
                            <select id="SPC" aria-label="Default select example" name="SPC" type="text"
                                class="form-select" required>
                                <option value="" disabled selected hidden>Select Sophic Project Category</option>
                                <option value="AIMMS-Automated Intelligent Material Management System">AIMMS-Automated
                                    Intelligent Material Management System</option>
                                <option value="AIVIS-Automated Intelligent Vision Inspection System">AIVIS-Automated
                                    Intelligent Vision Inspection System</option>
                                <option value="AMR-Automated Guided Vehicle/Automated Mobile Robot">AMR-Automated Guided
                                    Vehicle/Automated Mobile Robot</option>
                                <option value="ICCS-Intelligent Command Center System">ICCS-Intelligent Command Center
                                    System</option>
                                <option value="AIHTS-Automated Intelligent Handling and Testing System">AIHTS-Automated
                                    Intelligent Handling and Testing System</option>
                                <option value="ARSG-Augmented Reality Smart Glass">ARSG-Augmented Reality Smart Glass
                                </option>
                                <option value="OTHERS-Trading, PCB, Service, Office Use and etc">OTHERS-Trading, PCB,
                                    Service, Office Use and etc</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Procurement Category</label>
                            <input id="ProcurementCategory" name="ProcurementCategory" type="text" class="form-control"
                                required>
                        </div>
                        <div class="col-md-3">
                            <label class="labels">Project Description</label>
                            <input id="projectDescription" name="projectDescription" type="text" class="form-control"
                                required>
                        </div>
                    </div>
                    <div class="row px-4">

                    </div>
                    <div class="row p-4">
                        <div class="collapse" id="pr-collapse">
                            <div class=" card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label class="labels">Internal Use <small>(Opt.)</small></label>
                                        <input id="internalUse" name="internalUse" type="text" class="form-control">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="labels">Online Purchase <small>(Opt.)</small></label>
                                        <input id="onlinePurchase" name="onlinePurchase" type="text"
                                            class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% if (successMessage || errorMessage) { %>
                        <div class="text-center px-4">
                            <% if(successMessage) { %>
                                <div class="alert alert-success alert-sm alert-dismissible fade show" role="alert">
                                    <%= successMessage %>
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"
                                            aria-label="Close"></button>
                                </div>
                                <% } else if (errorMessage) { %>
                                    <div class="alert alert-danger alert-sm alert-dismissible fade show" role="alert">
                                        <%= errorMessage %>
                                            <button type="button" class="btn-close" data-bs-dismiss="alert"
                                                aria-label="Close"></button>
                                    </div>
                                    <% } %>
                        </div>
                        <% } %>
                            <!-- Display UiPath Status and Result -->
                            <ul id="process-status"></ul>
                            <div id="process-result"></div>
                            <div id="process-result2"></div>
                            <div id="error-message" style="color: red"></div>
                            <div class="row px-4">
                                <div class="col-md-12">
                                    <p class="d-inline-flex gap-1">
                                        <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#pr-collapse" aria-expanded="false"
                                            aria-controls="pr-collapse">
                                            See Optional Fields
                                        </button>
                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                            data-bs-target="#staticBackdrop">
                                            Add Product Details
                                        </button>
                                    </p>
                                </div>

                            </div>
                            <div class="row px-4 pb-4">

                                <!-- Modal -->
                                <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static"
                                    data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel"
                                    aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                                    Product
                                                    Details</h1>
                                                <button id="close-modal-button" type="button" class="btn-close"
                                                    data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div id="show-item">
                                                    <div class="row p-4">
                                                        <div class="col-md-1 mb-3">
                                                            <label class="labels">Item</label>
                                                            <input type="number" name="itemNumber" class="form-control"
                                                                id="itemNumber" readonly>
                                                        </div>

                                                        <div class="col-md-1 mb-3">
                                                            <label class="labels">Part No.</label>
                                                            <input type="text" name="partNumber[]" class="form-control"
                                                                required>
                                                        </div>

                                                        <div class="col-md-2 mb-3">
                                                            <label class="labels">Brand</label>
                                                            <input id="brand" type="text" name="brand[]"
                                                                class="form-control" required>
                                                        </div>
                                                        <div class="col-md-3 mb-3">
                                                            <label class="labels">Description</label>
                                                            <textarea class="form-control "
                                                                id="exampleFormControlTextarea1" rows="2"
                                                                name="description[]" required></textarea>
                                                        </div>
                                                        <div class="col-md-2 mb-3">
                                                            <label class="labels">Date Required</label>
                                                            <input type="date" name="dateRequired[]"
                                                                class="form-control" required>
                                                        </div>
                                                        <div class="col-md-1 mb-3">
                                                            <label class="labels">Qty</label>
                                                            <input id="quantity" type="number" name="quantity[]"
                                                                class="quantity form-control" min="1" required>
                                                        </div>
                                                        <div class="col-md-2 mb-3">
                                                            <label class="labels">Currency</label>
                                                            <input name="currency[]" type="text" class="form-control"
                                                                list="currency" id="currencyInput">
                                                            <datalist id="currency">
                                                                <option value="" selected disabled hidden>select
                                                                    currency
                                                                </option>
                                                                <option value="MYR">Malaysian Ringgit
                                                                </option>
                                                                <option value="ALL">Albanian Lek
                                                                </option>
                                                                <option value="SAR">Saudi Riyal</option>
                                                                <option value="USD">US Dollar</option>
                                                                <option value="POD">UK Pound</option>
                                                            </datalist>
                                                            <div id="error" style="color: red;"></div>
                                                        </div>

                                                        <div class="row">
                                                            <div class="collapse" id="pd-collapse">
                                                                <div class="row">
                                                                    <!-- DT Optional -->
                                                                    <div class="col-md-3 mb-3">
                                                                        <label class="labels">Delivery
                                                                            Term
                                                                            <small>(Opt.)</small></label>
                                                                        <input name="deliveryTerm" type="text"
                                                                            class="form-control">
                                                                    </div>

                                                                    <!-- LT Optional -->
                                                                    <div class="col-md-3 mb-3">
                                                                        <label class="labels">Lead Time
                                                                            <small>(Opt.)</small></label>
                                                                        <input name="leadTime" type="text"
                                                                            class="form-control">
                                                                    </div>

                                                                    <!-- Tax Optional -->
                                                                    <div class="col-md-3 mb-3">
                                                                        <label class="labels">Tax (%)
                                                                            <small>(Opt.)</small></label>
                                                                        <input id="tax" name="tax[]" type="number"
                                                                            min="0" class="form-control">
                                                                    </div>

                                                                    <!-- Tax Optional -->
                                                                    <div class="col-md-3 mb-3">
                                                                        <label class="labels">Exwork
                                                                            Address/Remark
                                                                            <small>(Opt.)</small></label>
                                                                        <input name="exwork" type="text"
                                                                            class="form-control">
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>

                                                        <div class="row">
                                                            <div class="col-md-2 mb-3">
                                                                <label class="labels">Unit Price</label>
                                                                <input id="unitPrice" type="number" name="unitPrice[]"
                                                                    class="unitPrice form-control" min="0" required>
                                                            </div>

                                                            <div class="col-md-2 mb-3">
                                                                <label class="labels">Total
                                                                    Price</label>
                                                                <input placeholder="Auto Calculated" id="totalPrice"
                                                                    name="totalPrice[]" type="number"
                                                                    class="totalPrice form-control" readonly>
                                                            </div>

                                                            <div class="col-md-6 mt-4">
                                                                <p class="d-inline-flex gap-1">
                                                                    <button class="btn btn-outline-primary"
                                                                        type="button" data-bs-toggle="collapse"
                                                                        data-bs-target="#pd-collapse"
                                                                        aria-expanded="false"
                                                                        aria-controls="pd-collapse">
                                                                        See Optional Fields
                                                                    </button>
                                                                    <!-- Add more In modal button -->
                                                                    <button type="button"
                                                                        class="btn btn-success add_item_btn">Add
                                                                        More</button>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row px-4">
                                                    <div class="col-md-2">
                                                        <label class="labels">Grand Total:</label>
                                                        <input id="grandTotal" name="grandTotal"
                                                            placeholder="Auto Calculated" class="form-control"
                                                            type="number" readonly>
                                                    </div>
                                                    <div class="col-md-2 mt-4">
                                                        <button type="submit" class="btn btn-primary w-100"
                                                            id="submit_modal_btn">Submit</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                </div>
            </div>
        </div>
    </form>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Popperjs -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <!-- Include jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- UiPath & Client-side script -->
    <script src="/CreatePRForm.js"></script>
    <script src="/UiPathRobot.js"></script>
    <script src="/scripts/purchaseRequest.js"></script>
</body>

</html>